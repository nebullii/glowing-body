---
import Layout from '../layouts/Layout.astro';
import BlogPostsList from '../components/BlogPostsList.astro';

const posts = await Promise.all(
  Object.entries(await import.meta.glob('./posts/*.md'))
    .map(async ([_, post]) => {
      const { frontmatter } = await post();
      return {
        url: post.url,
        frontmatter
      };
    })
);

const sortedPosts = posts.sort((a, b) => 
    new Date(b.frontmatter.pubDate).valueOf() - new Date(a.frontmatter.pubDate).valueOf()
);
---

<Layout title="Blog | Glowing Body">
    <main class="mx-auto max-w-6xl px-4 py-16">
        <header class="text-center max-w-3xl mx-auto mb-16">
            <h1 class="text-4xl md:text-5xl font-bold mb-8 text-white">
                The Blog
            </h1>
            <p class="text-xl text-gray-400">
                Discover insights about nutrition, mindful eating, and the latest in food science.
            </p>
        </header>

        <BlogPostsList posts={sortedPosts} showAll={true} />
    </main>
</Layout>